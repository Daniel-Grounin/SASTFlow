package com.sast;

import org.junit.jupiter.api.Test;
import static org.junit.jupiter.api.Assertions.*;

public class VulnerabilityCheckerTest {
    @Test
    public void testSQLInjectionDetection() {
        String sampleCode = "Statement stmt = conn.createStatement(); stmt.executeQuery(\"SELECT * FROM users\");";
        String result = VulnerabilityChecker.checkVulnerabilities(sampleCode);

        assertTrue(result.contains("SQL Injection Risk"), "Should detect SQL Injection");
    }

    @Test
    public void testHardcodedPasswordDetection() {
        String sampleCode = "String password = \"admin123\";";
        String result = VulnerabilityChecker.checkVulnerabilities(sampleCode);

        assertTrue(result.contains("Hardcoded Password Found"), "Should detect hardcoded password");
    }

    @Test
    public void testInsecureFileHandling() {
        String sampleCode = "File file = new File(\"/etc/passwd\");";
        String result = VulnerabilityChecker.checkVulnerabilities(sampleCode);

        assertTrue(result.contains("Insecure File Handling"), "Should detect insecure file access");
    }
}
