package com.sast;

import org.junit.jupiter.api.Test;
import java.util.List;
import static org.junit.jupiter.api.Assertions.*;

public class VulnerabilityCheckerTest {
    @Test
    public void testSQLInjectionDetection() {
        String sampleCode = "Statement stmt = conn.createStatement(); stmt.executeQuery(\"SELECT * FROM users\");";
        List<String> result = VulnerabilityChecker.checkVulnerabilities(sampleCode); // Expecting List<String>

        assertTrue(result.stream().anyMatch(v -> v.contains("SQL Injection Risk")), "Should detect SQL Injection");
    }

    @Test
    public void testHardcodedPasswordDetection() {
        String sampleCode = "String password = \"admin123\";";
        List<String> result = VulnerabilityChecker.checkVulnerabilities(sampleCode); // Expecting List<String>

        assertTrue(result.stream().anyMatch(v -> v.contains("Hardcoded Password Found")), "Should detect hardcoded password");
    }

    @Test
    public void testInsecureFileHandling() {
        String sampleCode = "File file = new File(\"/etc/passwd\");";
        List<String> result = VulnerabilityChecker.checkVulnerabilities(sampleCode); // Expecting List<String>

        assertTrue(result.stream().anyMatch(v -> v.contains("Insecure File Handling")), "Should detect insecure file access");
    }
}
